<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zero Agent - ×××©×§ ××©×•×œ×‘</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* Claude-inspired Design System */
        @import url('https://fonts.googleapis.com/css2?family=Lora:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap');
        
        :root {
            /* Claude Colors */
            --claude-primary: #da7756;
            --claude-primary-dark: #bd5d3a;
            --claude-bg: #eeece2;
            --claude-bg-light: #f5f3ee;
            --claude-text: #3d3929;
            --claude-text-light: #6b6654;
            --claude-border: #d5d3c8;
            --claude-white: #ffffff;
            --claude-shadow: rgba(61, 57, 41, 0.08);
            
            /* Spacing */
            --spacing-xs: 8px;
            --spacing-sm: 12px;
            --spacing-md: 16px;
            --spacing-lg: 20px;
            --spacing-xl: 24px;
            
            /* Border Radius */
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 20px;
        }
        
        body {
            font-family: ui-serif, Georgia, Cambria, "Times New Roman", Times, serif;
            background: var(--claude-bg);
            color: var(--claude-text);
            height: 100vh;
            overflow: hidden;
        }

        .container {
            display: flex;
            height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: var(--claude-white);
            padding: var(--spacing-lg);
            overflow-y: auto;
            box-shadow: 2px 0 12px var(--claude-shadow);
            border-right: 1px solid var(--claude-border);
        }

        .logo {
            text-align: center;
            margin-bottom: var(--spacing-xl);
            padding-bottom: var(--spacing-lg);
            border-bottom: 2px solid var(--claude-primary);
        }

        .logo h1 {
            font-family: ui-serif, Georgia, serif;
            color: var(--claude-primary);
            font-size: 32px;
            font-weight: 600;
            margin-bottom: 5px;
            letter-spacing: -0.5px;
        }

        .logo p {
            color: var(--claude-text-light);
            font-size: 13px;
            font-weight: 400;
        }

        .nav-item {
            padding: var(--spacing-md) var(--spacing-lg);
            margin: var(--spacing-xs) 0;
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all 0.25s ease;
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            color: var(--claude-text);
            background: transparent;
        }

        .nav-item:hover {
            background: var(--claude-bg-light);
            color: var(--claude-primary-dark);
            transform: translateX(-3px);
            box-shadow: 0 2px 8px var(--claude-shadow);
        }

        .nav-item.active {
            background: var(--claude-primary);
            color: var(--claude-white);
            box-shadow: 0 4px 12px rgba(218, 119, 86, 0.3);
        }

        .nav-item .icon {
            font-size: 20px;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: var(--spacing-lg);
            overflow-y: auto;
            background: var(--claude-bg);
        }

        .header {
            background: var(--claude-white);
            padding: var(--spacing-lg);
            border-radius: var(--radius-lg);
            margin-bottom: var(--spacing-lg);
            border: 1px solid var(--claude-border);
            box-shadow: 0 2px 12px var(--claude-shadow);
        }

        .search-bar {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s;
        }

        .search-bar:focus {
            outline: none;
            border-color: #00d9ff;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.3);
        }

        .content-area {
            display: none;
            background: var(--claude-white);
            padding: var(--spacing-xl);
            border-radius: var(--radius-lg);
            border: 1px solid var(--claude-border);
            box-shadow: 0 4px 16px var(--claude-shadow);
            animation: fadeIn 0.3s ease;
        }

        .content-area.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .content-area h2 {
            font-family: ui-serif, Georgia, serif;
            color: var(--claude-primary);
            margin-bottom: var(--spacing-lg);
            font-size: 28px;
            font-weight: 600;
            letter-spacing: -0.5px;
        }

        /* Chat Interface - Claude Style */
        .chat-container {
            display: flex;
            flex-direction: column;
            height: 600px;
            border: 1px solid var(--claude-border);
            border-radius: var(--radius-lg);
            overflow: hidden;
            background: var(--claude-bg-light);
        }

        .chat-messages {
            flex: 1;
            padding: var(--spacing-lg);
            overflow-y: auto;
            background: var(--claude-bg-light);
        }

        .message {
            margin-bottom: var(--spacing-md);
            padding: var(--spacing-md) var(--spacing-lg);
            border-radius: var(--radius-lg);
            max-width: 70%;
            animation: slideIn 0.3s ease;
            box-shadow: 0 2px 8px var(--claude-shadow);
            line-height: 1.6;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Typewriter effect for Zero responses */
        .message.zero.typewriter {
            overflow: hidden;
        }

        .message.zero.typewriter .message-content {
            border-right: 2px solid var(--claude-primary);
            animation: blink 0.75s infinite;
            padding-right: 3px;
        }

        @keyframes blink {
            0%, 50% { border-color: var(--claude-primary); }
            51%, 100% { border-color: transparent; }
        }

        .message.user {
            background: var(--claude-white);
            color: var(--claude-text);
            margin-left: auto;
            margin-right: var(--spacing-md);
            text-align: right;
            border: 1px solid var(--claude-border);
        }

        .message.zero {
            background: var(--claude-bg-light);
            color: var(--claude-text);
            margin-right: auto;
            margin-left: var(--spacing-md);
            border: 1px solid var(--claude-border);
        }

        .message-header {
            font-size: 12px;
            font-weight: 600;
            margin-bottom: var(--spacing-xs);
            color: var(--claude-text-light);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .chat-input-area {
            display: flex;
            padding: var(--spacing-md);
            background: var(--claude-white);
            border-top: 1px solid var(--claude-border);
            gap: var(--spacing-sm);
        }

        .chat-input {
            flex: 1;
            padding: var(--spacing-md);
            border: 2px solid var(--claude-border);
            border-radius: var(--radius-lg);
            font-size: 15px;
            font-family: ui-serif, Georgia, serif;
            color: var(--claude-text);
            background: var(--claude-bg-light);
            transition: all 0.25s ease;
            resize: vertical;
            min-height: 48px;
        }

        .chat-input:focus {
            outline: none;
            border-color: var(--claude-primary);
            box-shadow: 0 0 0 3px rgba(218, 119, 86, 0.1);
        }

        .send-btn {
            padding: var(--spacing-md) var(--spacing-xl);
            background: var(--claude-primary);
            color: var(--claude-white);
            border: none;
            border-radius: var(--radius-md);
            cursor: pointer;
            font-weight: 600;
            font-family: ui-serif, Georgia, serif;
            transition: all 0.25s ease;
            box-shadow: 0 2px 8px rgba(218, 119, 86, 0.3);
        }

        .send-btn:hover {
            background: var(--claude-primary-dark);
            box-shadow: 0 4px 12px rgba(218, 119, 86, 0.4);
            transform: translateY(-2px);
        }

        .send-btn:active {
            transform: translateY(0);
        }

        /* Code Editor */
        .code-editor {
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
        }

        .code-toolbar {
            background: #00d9ff;
            color: white;
            padding: 10px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .code-run-btn {
            padding: 8px 20px;
            background: white;
            color: #00d9ff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }

        .code-editor textarea {
            width: 100%;
            min-height: 400px;
            padding: 20px;
            border: none;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            resize: vertical;
        }

        /* Email Interface */
        .email-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .email-item {
            padding: 20px;
            background: #f9f9f9;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .email-item:hover {
            border-color: #00d9ff;
            transform: translateX(-5px);
        }

        .email-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .email-from {
            font-weight: bold;
            color: #00d9ff;
        }

        .email-date {
            color: #999;
            font-size: 12px;
        }

        .email-subject {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .email-preview {
            color: #666;
            font-size: 14px;
        }

        /* Calendar */
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
        }

        .calendar-day {
            aspect-ratio: 1;
            background: #f9f9f9;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .calendar-day:hover {
            border-color: #00d9ff;
            background: #f0f0ff;
        }

        .calendar-day.today {
            background: #00d9ff;
            color: white;
            border-color: #5568d3;
        }

        .day-number {
            font-weight: bold;
            font-size: 18px;
        }

        /* Database */
        .query-editor {
            margin-bottom: 20px;
        }

        .query-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            min-height: 150px;
            margin-bottom: 10px;
        }

        .execute-btn {
            padding: 12px 30px;
            background: #00d9ff;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            margin-bottom: 20px;
        }

        .result-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
        }

        .result-table th {
            background: #00d9ff;
            color: white;
            padding: 15px;
            text-align: right;
        }

        .result-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e0e0e0;
        }

        .result-table tr:hover {
            background: #f9f9f9;
        }

        /* Memory */
        .memory-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #00BFFF, #007ACC);
            color: #E0F7FF;
            padding: 25px;
            border-radius: 16px;
            text-align: center;
            border: 1px solid rgba(0, 191, 255, 0.3);
            box-shadow: 0 0 30px rgba(0, 191, 255, 0.3);
        }

        .stat-value {
            font-size: 36px;
            font-weight: bold;
            margin: 10px 0;
        }

        .stat-label {
            font-size: 14px;
            opacity: 0.9;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                width: 80px;
                padding: 10px;
            }

            .logo h1, .nav-item span {
                display: none;
            }
        }

        /* Enhanced Loading Animation - Phase 2 */
        .loading {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 12px 20px;
            background: rgba(0, 191, 255, 0.1);
            border-radius: 12px;
            color: #00BFFF;
            font-weight: 500;
            text-shadow: 0 0 10px rgba(0, 191, 255, 0.5);
            border: 1px solid rgba(0, 191, 255, 0.3);
        }

        .loading .spinner {
            width: 16px;
            height: 16px;
            border: 2px solid rgba(0, 191, 255, 0.3);
            border-top-color: #00BFFF;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading::after {
            content: '××—×©×‘';
            animation: thinking 2s infinite;
        }

        @keyframes thinking {
            0%, 100% { content: '××—×©×‘'; }
            33% { content: '××—×©×‘.'; }
            66% { content: '××—×©×‘..'; }
        }

        /* Old loading for backward compatibility */
        .loading.old::after {
            content: '...';
            animation: dots 1.5s infinite;
        }

        @keyframes dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60%, 100% { content: '...'; }
        }

        /* Saved Conversations */
        .saved-conversation {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .saved-conversation:hover {
            border-color: #00d9ff;
            transform: translateX(-5px);
            box-shadow: 0 4px 10px rgba(102, 126, 234, 0.2);
        }

        .conv-header {
            font-size: 18px;
            font-weight: bold;
            color: #00d9ff;
            margin-bottom: 5px;
        }

        .conv-date {
            font-size: 14px;
            color: #999;
            margin-bottom: 8px;
        }

        .conv-preview {
            font-size: 13px;
            color: #666;
        }

        /* Artifacts Zone - Phase 3 */
        .artifacts-zone {
            margin-top: 15px;
            padding: 15px;
            background: rgba(15, 22, 41, 0.6);
            border: 1px solid rgba(0, 191, 255, 0.3);
            border-radius: 10px;
            max-height: 300px;
            overflow-y: auto;
        }

        .artifacts-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            color: #00BFFF;
            font-weight: 600;
            font-size: 14px;
        }

        .artifact {
            background: rgba(0, 122, 204, 0.1);
            border: 1px solid rgba(0, 191, 255, 0.3);
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 10px;
            position: relative;
        }

        .artifact-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .artifact-title {
            font-weight: 600;
            color: #33FFFF;
            font-size: 13px;
        }

        .artifact-actions {
            display: flex;
            gap: 5px;
        }

        .artifact-btn {
            padding: 4px 10px;
            background: rgba(0, 191, 255, 0.2);
            border: 1px solid rgba(0, 191, 255, 0.4);
            border-radius: 5px;
            cursor: pointer;
            font-size: 11px;
            color: #00BFFF;
            transition: all 0.2s;
        }

        .artifact-btn:hover {
            background: rgba(0, 191, 255, 0.4);
            transform: scale(1.05);
        }

        .artifact-content {
            background: rgba(10, 15, 31, 0.8);
            padding: 10px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            color: #E0F7FF;
            max-height: 150px;
            overflow-y: auto;
        }

        .close-artifacts {
            cursor: pointer;
            opacity: 0.6;
            transition: opacity 0.2s;
        }

        .close-artifacts:hover {
            opacity: 1;
        }

        /* Artifacts Panel - Claude Style */
        .artifacts-panel {
            width: 0;
            background: var(--claude-white);
            border-left: 1px solid var(--claude-border);
            transition: all 0.3s ease;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .artifacts-panel.open {
            width: 45%;
            min-width: 400px;
        }

        .artifacts-header {
            padding: var(--spacing-lg);
            border-bottom: 1px solid var(--claude-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--claude-bg-light);
        }

        .artifacts-header h3 {
            font-family: ui-serif, Georgia, serif;
            color: var(--claude-primary);
            font-size: 18px;
            font-weight: 600;
            margin: 0;
        }

        .artifacts-tabs {
            display: flex;
            gap: var(--spacing-sm);
            padding: var(--spacing-md) var(--spacing-lg);
            border-bottom: 1px solid var(--claude-border);
            background: var(--claude-bg-light);
        }

        .artifacts-tab {
            padding: var(--spacing-sm) var(--spacing-md);
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: all 0.25s ease;
            font-weight: 500;
            font-size: 14px;
            color: var(--claude-text-light);
        }

        .artifacts-tab.active {
            background: var(--claude-primary);
            color: var(--claude-white);
        }

        .artifacts-tab:hover:not(.active) {
            background: var(--claude-border);
        }

        .artifacts-body {
            flex: 1;
            overflow-y: auto;
            padding: var(--spacing-lg);
        }

        .artifacts-code {
            background: #1e1e1e;
            border-radius: var(--radius-md);
            padding: var(--spacing-md);
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
            color: #d4d4d4;
            overflow-x: auto;
            border: 1px solid var(--claude-border);
        }

        .artifacts-preview {
            background: var(--claude-white);
            border-radius: var(--radius-md);
            padding: var(--spacing-lg);
            border: 1px solid var(--claude-border);
            min-height: 200px;
        }

        .artifacts-actions {
            padding: var(--spacing-md) var(--spacing-lg);
            border-top: 1px solid var(--claude-border);
            display: flex;
            gap: var(--spacing-sm);
            background: var(--claude-bg-light);
        }

        .artifacts-btn {
            padding: var(--spacing-sm) var(--spacing-md);
            background: var(--claude-white);
            border: 1px solid var(--claude-border);
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            color: var(--claude-text);
            transition: all 0.25s ease;
        }

        .artifacts-btn:hover {
            background: var(--claude-primary);
            color: var(--claude-white);
            border-color: var(--claude-primary);
        }

        .close-panel-btn {
            background: transparent;
            border: none;
            cursor: pointer;
            font-size: 20px;
            color: var(--claude-text-light);
            transition: color 0.25s ease;
        }

        .close-panel-btn:hover {
            color: var(--claude-primary);
        }

        /* Enhanced Typing Indicator */
        .typing-indicator {
            display: flex;
            gap: 4px;
            padding: var(--spacing-md);
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: var(--claude-primary);
            border-radius: 50%;
            animation: typing-bounce 1.4s infinite;
        }

        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing-bounce {
            0%, 60%, 100% {
                transform: translateY(0);
                opacity: 0.7;
            }
            30% {
                transform: translateY(-10px);
                opacity: 1;
            }
        }

        /* ========================================
           RESPONSIVE DESIGN - Mobile & Tablet
           ======================================== */

        /* Tablet (768px - 1024px) */
        @media (max-width: 1024px) {
            .container {
                grid-template-columns: 200px 1fr;
            }

            .sidebar {
                width: 200px;
                padding: var(--spacing-md);
            }

            .logo h1 {
                font-size: 20px;
            }

            .logo p {
                font-size: 11px;
            }

            .nav-item {
                padding: var(--spacing-sm);
                font-size: 13px;
            }

            .artifacts-panel.open {
                width: 40%;
                min-width: 300px;
            }

            .message {
                max-width: 85%;
            }

            .chat-input {
                font-size: 14px;
            }
        }

        /* Mobile (max 768px) */
        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
                position: relative;
            }

            /* Sidebar becomes overlay */
            .sidebar {
                position: fixed;
                left: -100%;
                top: 0;
                bottom: 0;
                width: 280px;
                z-index: 1000;
                transition: left 0.3s ease;
                box-shadow: 2px 0 10px rgba(0, 0, 0, 0.2);
            }

            .sidebar.open {
                left: 0;
            }

            /* Sidebar overlay backdrop */
            .sidebar-backdrop {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0, 0, 0, 0.5);
                z-index: 999;
            }

            .sidebar-backdrop.active {
                display: block;
            }

            /* Main content full width */
            .main-content {
                padding: var(--spacing-md);
            }

            /* Add hamburger menu button */
            .mobile-menu-btn {
                display: block;
                position: fixed;
                top: 20px;
                left: 20px;
                z-index: 998;
                background: var(--claude-primary);
                color: var(--claude-white);
                border: none;
                border-radius: var(--radius-sm);
                padding: 12px 16px;
                font-size: 20px;
                cursor: pointer;
                box-shadow: 0 2px 8px rgba(218, 119, 86, 0.3);
                transition: all 0.25s ease;
            }

            .mobile-menu-btn:hover {
                transform: scale(1.05);
                box-shadow: 0 4px 12px rgba(218, 119, 86, 0.4);
            }

            /* Header adjustments */
            .header {
                margin-top: 50px;
                flex-direction: column;
                gap: var(--spacing-sm);
            }

            .header > div {
                width: 100%;
            }

            .search-bar {
                width: 100% !important;
            }

            /* Message bubbles */
            .message {
                max-width: 90%;
                padding: var(--spacing-md);
            }

            .message.user {
                margin-left: 5%;
            }

            .message.zero {
                margin-right: 5%;
            }

            /* Chat input area */
            .chat-input-area {
                flex-direction: column;
                gap: var(--spacing-sm);
            }

            .chat-input {
                min-height: 80px;
                font-size: 16px; /* Prevents zoom on iOS */
            }

            .send-btn {
                width: 100%;
                padding: var(--spacing-md);
            }

            /* Artifacts panel becomes full screen overlay on mobile */
            .artifacts-panel.open {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                width: 100%;
                min-width: 0;
                z-index: 1001;
            }

            /* Hide desktop artifacts button, show mobile one */
            .header button {
                padding: var(--spacing-sm) var(--spacing-md);
                font-size: 14px;
            }

            /* Content areas */
            .content-area h2 {
                font-size: 22px;
            }

            /* Forms and inputs */
            input[type="text"],
            input[type="email"],
            textarea,
            select {
                font-size: 16px; /* Prevents zoom on iOS */
            }

            /* Projects list */
            .project-item {
                padding: var(--spacing-sm);
            }

            /* Calendar adjustments */
            #calendar {
                font-size: 12px;
            }

            /* Responsive tables */
            table {
                font-size: 12px;
            }

            th, td {
                padding: var(--spacing-sm);
            }
        }

        /* Small mobile (max 480px) */
        @media (max-width: 480px) {
            .sidebar {
                width: 100%;
            }

            .logo h1 {
                font-size: 18px;
            }

            .message {
                max-width: 95%;
                font-size: 14px;
            }

            .message-header {
                font-size: 10px;
            }

            .content-area h2 {
                font-size: 18px;
            }

            .send-btn {
                font-size: 14px;
            }

            .artifacts-header h3 {
                font-size: 16px;
            }

            .artifacts-tab {
                font-size: 12px;
                padding: 6px 10px;
            }

            .artifacts-btn {
                font-size: 12px;
                padding: 6px 10px;
            }
        }

        /* Hide mobile menu button on desktop */
        @media (min-width: 769px) {
            .mobile-menu-btn {
                display: none;
            }
        }

        /* Landscape mobile optimization */
        @media (max-width: 768px) and (orientation: landscape) {
            .chat-input {
                min-height: 60px;
            }

            .message {
                padding: 8px 12px;
            }

            .header {
                margin-top: 60px;
            }
        }

        /* High DPI screens */
        @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
            .message,
            .nav-item,
            .send-btn {
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }
        }

        /* Accessibility - Reduce Motion */
        @media (prefers-reduced-motion: reduce) {
            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        /* Dark mode support (future enhancement) */
        @media (prefers-color-scheme: dark) {
            /* ĞœĞ¾Ğ¶Ğ½Ğ¾ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ñ‚ĞµĞ¼Ğ½ÑƒÑ Ñ‚ĞµĞ¼Ñƒ Ğ² Ğ±ÑƒĞ´ÑƒÑ‰ĞµĞ¼ */
        }
    </style>
</head>
<body>
    <!-- Mobile Menu Button -->
    <button class="mobile-menu-btn" onclick="toggleMobileSidebar()">â˜°</button>
    
    <!-- Sidebar Backdrop -->
    <div class="sidebar-backdrop" onclick="closeMobileSidebar()"></div>
    
    <div class="container">
        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <div class="logo">
                <img src="/zero_logo/generated-image.png" alt="Zero Logo" style="width: 80px; height: 80px; border-radius: 50%; margin-bottom: 10px; object-fit: cover;">
                <h1>ğŸš€ Zero</h1>
                <p>AI Agent Platform</p>
            </div>

            <!-- Projects Section -->
            <div style="margin-bottom: 20px;">
                <div style="font-size: 12px; color: #A0C8FF; margin-bottom: 10px; font-weight: 600;">PROJECTS</div>
                <div id="projects-list"></div>
                <div class="nav-item" onclick="showNewProjectDialog()" style="margin-top: 5px; opacity: 0.7;">
                    <span class="icon">â•</span>
                    <span>×¤×¨×•×™×§×˜ ×—×“×©</span>
                </div>
            </div>

            <!-- Divider -->
            <div style="border-bottom: 1px solid rgba(0, 191, 255, 0.2); margin: 20px 0;"></div>

            <!-- Tools Section -->
            <div style="font-size: 12px; color: #A0C8FF; margin-bottom: 10px; font-weight: 600;">TOOLS</div>
            
            <div class="nav-item" onclick="showContent('chat')">
                <span class="icon">ğŸ’¬</span>
                <span>×¦'××˜</span>
            </div>
            <div class="nav-item" onclick="showContent('code')">
                <span class="icon">ğŸ’»</span>
                <span>×§×•×“</span>
            </div>
            <div class="nav-item" onclick="showContent('email')">
                <span class="icon">ğŸ“§</span>
                <span>××™××™×™×œ</span>
            </div>
            <div class="nav-item" onclick="showContent('calendar')">
                <span class="icon">ğŸ“…</span>
                <span>×œ×•×— ×©× ×”</span>
            </div>
            <div class="nav-item" onclick="showContent('database')">
                <span class="icon">ğŸ—„ï¸</span>
                <span>××¡×“ × ×ª×•× ×™×</span>
            </div>
            <div class="nav-item" onclick="showContent('memory')">
                <span class="icon">ğŸ§ </span>
                <span>×–×™×›×¨×•×Ÿ</span>
            </div>
            <div class="nav-item" onclick="showContent('project-review')">
                <span class="icon">ğŸ”</span>
                <span>×¡×§×™×¨×ª ×¤×¨×•×™×§×˜</span>
            </div>
            <div class="nav-item" onclick="showContent('saved-conversations')">
                <span class="icon">ğŸ“š</span>
                <span>×©×™×—×•×ª ×©××•×¨×•×ª</span>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <div class="header">
                <div style="display: flex; gap: 12px; align-items: center;">
                    <input type="text" class="search-bar" placeholder="×—×¤×© ××• ×©××œ ××©×”×•..." onkeypress="handleSearch(event)" style="flex: 1;">
                    <button class="send-btn" onclick="toggleArtifactsPanel()" style="padding: 12px 20px; white-space: nowrap;">
                        ğŸ“¦ Artifacts
                    </button>
                </div>
            </div>

            <!-- Chat Interface -->
            <div id="chat" class="content-area active">
                <h2>ğŸ’¬ ×©×™×—×” ×¢× Zero</h2>
                <div style="margin-bottom: 10px; display: flex; gap: 10px;">
                    <button class="send-btn" onclick="copyConversation()" style="background: #28a745;">ğŸ“‹ ×”×¢×ª×§ ×©×™×—×”</button>
                    <button class="send-btn" onclick="saveConversation()" style="background: #ffc107; color: #333;">ğŸ’¾ ×©××•×¨ ×©×™×—×”</button>
                </div>
                <div class="chat-container">
                    <div class="chat-messages" id="chatMessages">
                        <div class="message zero">
                            <div class="message-header">ğŸ¤– Zero Agent</div>
                            ×©×œ×•×! ×× ×™ Zero Agent. ××™×š ×× ×™ ×™×›×•×œ ×œ×¢×–×•×¨ ×œ×š ×”×™×•×?
                        </div>
                    </div>
                    <div class="chat-input-area">
                        <input type="text" class="chat-input" id="chatInput" placeholder="×”×§×œ×“ ×”×•×“×¢×”..." onkeypress="handleChatInput(event)">
                        <button class="send-btn" onclick="toggleRecording()" id="micBtn" style="background: #e91e63; margin-right: 10px;" title="×”×§×œ×˜ ×“×™×‘×•×¨ (× ×“×¨×© localhost)">ğŸ¤ ×”×§×œ×˜</button>
                        <button class="send-btn" onclick="stopConversation()" id="stopBtn" style="background: #dc3545; margin-right: 10px; display: none;" title="×¢×¦×•×¨ ×©×™×—×”">â¹ï¸ ×¢×¦×•×¨</button>
                        <button class="send-btn" onclick="toggleStreaming()" id="streamBtn" style="background: #7c3aed; margin-right: 10px;" title="Streaming Mode">ğŸ“¡ Streaming</button>
                        <button class="send-btn" onclick="sendMessage()" id="sendBtn">×©×œ×—</button>
                    </div>
                    <div id="micWarning" style="display: none; padding: 10px; background: #fff3cd; border: 2px solid #ffc107; border-radius: 10px; margin-top: 10px; color: #856404;">
                        <strong>âš ï¸ ×’×™×©×” ×œ××™×§×¨×•×¤×•×Ÿ ×–××™× ×” ×¨×§ ×“×¨×š localhost:</strong><br>
                        ×¤×ª×— ××ª ×”×××©×§ ×“×¨×š: <code>http://localhost:8080/zero_web_interface.html</code><br>
                        ××• ×¤×©×•×˜ ×”×§×œ×“ ××ª ×”×”×•×“×¢×” ×‘×©×“×” ×”×˜×§×¡×˜ â†‘
                    </div>
                </div>
                <!-- Artifacts Zone -->
                <div id="artifactsZone" class="artifacts-zone" style="display: none;">
                    <div class="artifacts-header">
                        <span>ğŸ¨ Artifacts</span>
                        <span class="close-artifacts" onclick="closeArtifacts()">âœ•</span>
                    </div>
                    <div id="artifactsContainer"></div>
                </div>
            </div>

            <!-- Code Editor -->
            <div id="code" class="content-area">
                <h2>ğŸ’» ×¢×•×¨×š ×§×•×“</h2>
                <div class="code-editor">
                    <div class="code-toolbar">
                        <span>Code Editor</span>
                        <button class="code-run-btn" onclick="runCode()">â–¶ ×”×¤×¢×œ</button>
                    </div>
                    <textarea id="codeEditor" placeholder="×”×›× ×¡ ××ª ×”×§×•×“ ×©×œ×š ×›××Ÿ..."># ×“×•×’××”
def hello_zero():
    print("×©×œ×•× ×-Zero Agent!")
    return "Code executed successfully"

result = hello_zero()
print(result)
</textarea>
                </div>
                <div id="codeOutput" style="margin-top: 20px; padding: 20px; background: #f9f9f9; border-radius: 10px; display: none;"></div>
            </div>

            <!-- Email -->
            <div id="email" class="content-area">
                <h2>ğŸ“§ × ×™×”×•×œ ××™××™×™×œ</h2>
                <button class="send-btn" style="margin-bottom: 20px;" onclick="loadEmails()">ğŸ”„ ×˜×¢×Ÿ ××™××™×™×œ×™×</button>
                <div class="email-list" id="emailList">
                    <div class="email-item">
                        <div class="email-header">
                            <span class="email-from">×’×•×’×œ</span>
                            <span class="email-date">×”×™×•× 10:30</span>
                        </div>
                        <div class="email-subject">×”×¢×“×›×•×Ÿ ×”×—×“×© ×–××™×Ÿ</div>
                        <div class="email-preview">×™×© ×œ×š ×¢×“×›×•×Ÿ ×—×“×© ×‘×”×’×“×¨×•×ª ×”×—×©×‘×•×Ÿ ×©×œ×š...</div>
                    </div>
                </div>
            </div>

            <!-- Calendar -->
            <div id="calendar" class="content-area">
                <h2>ğŸ“… ×œ×•×— ×©× ×”</h2>
                <div class="calendar-grid" id="calendarGrid"></div>
            </div>

            <!-- Database -->
            <div id="database" class="content-area">
                <h2>ğŸ—„ï¸ ××¡×“ × ×ª×•× ×™×</h2>
                <div class="query-editor">
                    <textarea class="query-input" placeholder="×”×›× ×¡ ×©××™×œ×ª×ª SQL ×›××Ÿ...">SELECT * FROM users LIMIT 10;</textarea>
                    <button class="execute-btn" onclick="executeQuery()">â–¶ ×”×¤×¢×œ ×©××™×œ×ª×”</button>
                </div>
                <div id="queryResults"></div>
            </div>

            <!-- Memory -->
            <div id="memory" class="content-area">
                <h2>ğŸ§  ×–×™×›×¨×•×Ÿ ×•××¢×¨×›×•×ª</h2>
                <div class="memory-stats" id="memoryStats">
                    <div class="stat-card">
                        <div class="stat-label">×¡×”"×› ×©×™×—×•×ª</div>
                        <div class="stat-value" id="memoriesCount">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">×©×™×—×•×ª 24 ×©×¢×•×ª</div>
                        <div class="stat-value" id="conversationsCount">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">×”×¢×“×¤×•×ª ×¢×•×‘×“</div>
                        <div class="stat-value" id="responsesCount">0</div>
                    </div>
                </div>
            </div>

            <!-- Project Review -->
            <div id="project-review" class="content-area">
                <h2>ğŸ” ×¡×§×™×¨×ª ×¤×¨×•×™×§×˜ ××§×¦×•×¢×™×ª</h2>
                <p style="margin-bottom: 20px; color: #666;">×‘×§×© ×-Zero ×œ× ×ª×— ×¤×¨×•×™×§×˜ ×•×œ×¡×¤×§ ×—×•×•×ª ×“×¢×ª ××§×¦×•×¢×™×ª</p>
                
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 10px; font-weight: bold;">× ×ª×™×‘ ×”×¤×¨×•×™×§×˜:</label>
                    <input type="text" id="projectPath" placeholder="×œ××©×œ: C:\Projects\MyProject" 
                           style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 14px; margin-bottom: 15px;"
                           value=".">
                    
                    <label style="display: block; margin-bottom: 10px; font-weight: bold;">×¡×•×’ ×¡×§×™×¨×”:</label>
                    <select id="reviewType" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 14px; margin-bottom: 15px;">
                        <option value="full">×¡×§×™×¨×” ××œ××”</option>
                        <option value="quick">×¡×§×™×¨×” ××”×™×¨×”</option>
                        <option value="security">××‘×˜×—×”</option>
                        <option value="architecture">××¨×›×™×˜×§×˜×•×¨×”</option>
                    </select>
                    
                    <button class="send-btn" onclick="reviewProject()" style="width: 100%;">ğŸ“Š ×”×ª×—×œ ×¡×§×™×¨×”</button>
                </div>

                <div id="projectReviewResults" style="margin-top: 30px;"></div>
            </div>

            <!-- Saved Conversations -->
            <div id="saved-conversations" class="content-area">
                <h2>ğŸ“š ×©×™×—×•×ª ×©××•×¨×•×ª</h2>
                <div id="conversationsList" style="margin-top: 20px;"></div>
                <script>
                    document.addEventListener('DOMContentLoaded', loadSavedConversations);
                </script>
            </div>
        </div>

        <!-- Artifacts Panel -->
        <div class="artifacts-panel" id="artifactsPanel">
            <div class="artifacts-header">
                <h3>ğŸ“¦ Artifacts</h3>
                <button class="close-panel-btn" onclick="toggleArtifactsPanel()">âœ•</button>
            </div>
            
            <div class="artifacts-tabs">
                <div class="artifacts-tab active" onclick="switchArtifactsTab('preview')">×ª×¦×•×’×” ××§×“×™××”</div>
                <div class="artifacts-tab" onclick="switchArtifactsTab('code')">×§×•×“</div>
            </div>
            
            <div class="artifacts-body">
                <div id="artifactsPreview" class="artifacts-preview">
                    <p style="color: var(--claude-text-light); text-align: center; margin-top: 40px;">
                        ××™×Ÿ ×ª×•×›×Ÿ ×œ×”×¦×’×” ×›×¨×’×¢
                    </p>
                </div>
                <div id="artifactsCode" class="artifacts-code" style="display: none;">
                    <pre><code>// No code to display</code></pre>
                </div>
            </div>
            
            <div class="artifacts-actions">
                <button class="artifacts-btn" onclick="copyArtifactCode()">ğŸ“‹ ×”×¢×ª×§</button>
                <button class="artifacts-btn" onclick="downloadArtifact()">â¬‡ï¸ ×”×•×¨×“</button>
                <button class="artifacts-btn" onclick="clearArtifacts()">ğŸ—‘ï¸ × ×§×”</button>
            </div>
        </div>
    </div>

    <script>
        const API_URL = 'http://localhost:8080';
        let streamingMode = false;
        let allModelsUsed = {}; // Track all models used in this session

        // Available models list
        const AVAILABLE_MODELS = [
            'fast',
            'DeepSeek-R1-32B',
            'Llama-3.1-8B',
            'Qwen-2.5-Coder-32B'
        ];

        // Voice recording variables
        let isRecording = false;
        let mediaRecorder = null;
        let audioChunks = [];

        // Voice Recording Functions
        async function toggleRecording() {
            if (!isRecording) {
                // Start recording
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                    audioChunks = [];
                    mediaRecorder = new MediaRecorder(stream);
                    
                    mediaRecorder.ondataavailable = (event) => {
                        audioChunks.push(event.data);
                    };
                    
                    mediaRecorder.onstop = async () => {
                        const audioBlob = new Blob(audioChunks, { type: 'audio/wav' });
                        await transcribeAudio(audioBlob);
                        stream.getTracks().forEach(track => track.stop());
                    };
                    
                    mediaRecorder.start();
                    isRecording = true;
                    
                    const micBtn = document.getElementById('micBtn');
                    micBtn.style.background = '#dc3545';
                    micBtn.innerHTML = 'â¹ï¸ ×¢×¦×•×¨ ×”×§×œ×˜×”';
                    micBtn.title = '×¢×¦×•×¨ ×”×§×œ×˜×”';
                } catch (error) {
                    console.error('Error starting recording:', error);
                    // Show warning message
                    document.getElementById('micWarning').style.display = 'block';
                    alert('âŒ ×’×™×©×” ×œ××™×§×¨×•×¤×•×Ÿ ×–××™× ×” ×¨×§ ×“×¨×š localhost\n\n×¤×ª×— ××ª ×”×××©×§ ×“×¨×š: http://localhost:8080/zero_web_interface.html');
                }
            } else {
                // Stop recording
                if (mediaRecorder && mediaRecorder.state !== 'inactive') {
                    mediaRecorder.stop();
                    isRecording = false;
                    
                    const micBtn = document.getElementById('micBtn');
                    micBtn.style.background = '#e91e63';
                    micBtn.innerHTML = 'ğŸ¤ ×”×§×œ×˜';
                    micBtn.title = '×”×§×œ×˜ ×“×™×‘×•×¨';
                }
            }
        }

        // Transcribe audio using Whisper API
        async function transcribeAudio(audioBlob) {
            try {
                // Convert audio to base64
                const reader = new FileReader();
                reader.readAsDataURL(audioBlob);
                
                reader.onloadend = async () => {
                    const base64Audio = reader.result.split(',')[1]; // Remove data:audio/wav;base64, prefix
                    
                    try {
                        const response = await fetch(`${API_URL}/api/voice/transcribe`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                audio_base64: base64Audio,
                                language: 'he'
                            })
                        });
                        
                        const data = await response.json();
                        
                        if (data.text) {
                            // Show transcribed text in input
                            document.getElementById('chatInput').value = data.text;
                            addMessageToChat('user', `ğŸ¤ ${data.text}`);
                            
                            // Automatically send to Zero
                            await sendMessageWithText(data.text);
                        }
                    } catch (error) {
                        console.error('Transcription error:', error);
                        alert('×©×’×™××” ×‘×”××¨×ª ×“×™×‘×•×¨ ×œ×˜×§×¡×˜');
                    }
                };
            } catch (error) {
                console.error('Error processing audio:', error);
                alert('×©×’×™××” ×‘×¢×™×‘×•×“ ×”×©××¢');
            }
        }

        // Send message with specific text
        async function sendMessageWithText(text) {
            if (!text.trim()) return;
            
            try {
                const response = await fetch(`${API_URL}/api/chat`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        message: text,
                        use_memory: true
                    })
                });
                
                const data = await response.json();
                
                // Add response
                addMessageToChat('zero', data.response + getModelInfoDisplay(data.model_used, true));
                
                // Speak response using Web Speech API
                speakText(data.response);
            } catch (error) {
                console.error('Error sending message:', error);
                alert('×©×’×™××” ×‘×©×œ×™×—×ª ×”×•×“×¢×”');
            }
        }

        // Text-to-Speech using Web Speech API
        function speakText(text) {
            if (!('speechSynthesis' in window)) {
                console.log('Text-to-Speech not supported');
                return;
            }
            
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'he-IL'; // Hebrew
            utterance.rate = 1.0;
            utterance.pitch = 1.0;
            utterance.volume = 1.0;
            
            speechSynthesis.speak(utterance);
        }

        // Function to get model info display
        function getModelInfoDisplay(modelName, showAllModels = false) {
            if (!modelName) return '';
            
            // Track this model as used
            allModelsUsed[modelName] = (allModelsUsed[modelName] || 0) + 1;
            
            let display = `<div style="font-size: 10px; margin-top: 8px; opacity: 0.7; padding: 8px; background: rgba(0,217,255,0.1); border-radius: 5px; border-left: 3px solid #00d9ff;">ğŸ“Š ××•×“×œ ×‘×©×™××•×©: <strong>${modelName}</strong>`;
            
            // Show all available models for this session
            if (showAllModels) {
                const otherModels = AVAILABLE_MODELS.filter(m => m !== modelName);
                if (otherModels.length > 0) {
                    display += '<br>ğŸ”§ ××•×“×œ×™× ×–××™× ×™×: ' + otherModels.join(', ');
                }
                
                // Show how many times each model was used in this session
                const usedModels = Object.keys(allModelsUsed).filter(m => allModelsUsed[m] > 0);
                if (usedModels.length > 1) {
                    const usageStats = usedModels.map(m => `${m} (${allModelsUsed[m]}x)`).join(', ');
                    display += '<br>ğŸ“ˆ ×¡×˜×˜×™×¡×˜×™×§×•×ª: ' + usageStats;
                }
            }
            
            display += '</div>';
            return display;
        }

        // Navigation
        function showContent(contentId) {
            document.querySelectorAll('.content-area').forEach(area => {
                area.classList.remove('active');
            });
            document.getElementById(contentId).classList.add('active');

            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            event.target.closest('.nav-item').classList.add('active');

            // Initialize content
            if (contentId === 'calendar') {
                initCalendar();
            } else if (contentId === 'memory') {
                loadMemoryStats();
            } else if (contentId === 'saved-conversations') {
                loadSavedConversations();
            }
        }

        // Chat
        function handleChatInput(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        function addMessageToChat(sender, text, id = null) {
            const messagesDiv = document.getElementById('chatMessages');
            const messageId = id || `msg-${Date.now()}`;
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            messageDiv.id = messageId;

            if (sender === 'zero') {
                // Enhanced loading animation
                if (text === '××—×¤×© ×ª×©×•×‘×”...' || text.includes('×—×•×©×‘')) {
                    messageDiv.innerHTML = `
                        <div class="message-header">ğŸ¤– Zero Agent</div>
                        <div class="loading">
                            <div class="spinner"></div>
                        </div>
                    `;
                } else {
                    messageDiv.innerHTML = `
                        <div class="message-header">ğŸ¤– Zero Agent</div>
                        ${text}
                    `;
                }
            } else {
                messageDiv.innerHTML = `
                    <div class="message-header">ğŸ‘¤ ××ª×”</div>
                    ${text}
                `;
            }

            messagesDiv.appendChild(messageDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;

            return messageId;
        }

        // Search
        function handleSearch(event) {
            if (event.key === 'Enter') {
                const query = event.target.value;
                if (query) {
                    showContent('chat');
                    document.getElementById('chatInput').value = query;
                    sendMessage();
                }
            }
        }

        // Code Execution
        async function runCode() {
            const code = document.getElementById('codeEditor').value;
            const outputDiv = document.getElementById('codeOutput');

            outputDiv.style.display = 'block';
            outputDiv.innerHTML = '<div class="loading">××¨×™×¥ ×§×•×“</div>';

            try {
                // In real implementation, you'd send this to Zero's code execution API
                const response = await fetch(`${API_URL}/api/chat`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        message: `Execute this Python code:\n\n${code}`,
                        model: 'coder'
                    })
                });

                const data = await response.json();
                outputDiv.innerHTML = `
                    <strong>×¤×œ×˜:</strong><br>
                    <pre>${data.response || 'No output'}</pre>
                    ${getModelInfoDisplay(data.model_used, true)}
                `;
            } catch (error) {
                outputDiv.innerHTML = `<strong>×©×’×™××”:</strong> ${error.message}`;
            }
        }

        // Calendar
        async function initCalendar() {
            const grid = document.getElementById('calendarGrid');
            const today = new Date();
            const firstDay = new Date(today.getFullYear(), today.getMonth(), 1).getDay();

            // Fetch today's events
            let events = [];
            try {
                const response = await fetch(`${API_URL}/api/tools/calendar`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ action: 'today' })
                });
                const data = await response.json();
                if (data.success && data.result) {
                    events = Array.isArray(data.result) ? data.result : [data.result];
                }
            } catch (error) {
                console.error('Failed to load calendar events:', error);
            }

            // Create a map of day to events
            const eventsMap = new Map();
            events.forEach(event => {
                const eventDate = new Date(event.start || event.date);
                const day = eventDate.getDate();
                if (!eventsMap.has(day)) {
                    eventsMap.set(day, []);
                }
                eventsMap.get(day).push(event);
            });

            // Add day headers
            const days = ['×', '×‘', '×’', '×“', '×”', '×•', '×©'];
            grid.innerHTML = '';

            days.forEach(day => {
                const dayHeader = document.createElement('div');
                dayHeader.style.textAlign = 'center';
                dayHeader.style.fontWeight = 'bold';
                dayHeader.style.padding = '10px';
                dayHeader.textContent = day;
                grid.appendChild(dayHeader);
            });

            // Add empty cells for days before month start
            for (let i = 0; i < (firstDay + 6) % 7; i++) {
                const empty = document.createElement('div');
                grid.appendChild(empty);
            }

            // Add days
            const daysInMonth = new Date(today.getFullYear(), today.getMonth() + 1, 0).getDate();
            for (let day = 1; day <= daysInMonth; day++) {
                const dayDiv = document.createElement('div');
                dayDiv.className = 'calendar-day';
                if (day === today.getDate()) {
                    dayDiv.classList.add('today');
                }
                
                let dayContent = `<div class="day-number">${day}</div>`;
                
                // Add event indicators
                if (eventsMap.has(day)) {
                    dayContent += `<div style="font-size: 10px; margin-top: 5px; color: #00d9ff;">ğŸ“… ${eventsMap.get(day).length}</div>`;
                }
                
                dayDiv.innerHTML = dayContent;
                grid.appendChild(dayDiv);
            }
        }

        // Database
        async function executeQuery() {
            const query = document.querySelector('.query-input').value;
            const resultsDiv = document.getElementById('queryResults');

            resultsDiv.innerHTML = '<div class="loading">××¨×™×¥ ×©××™×œ×ª×”</div>';

            try {
                const response = await fetch(`${API_URL}/api/tools/database`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        action: 'query',
                        query: query
                    })
                });

                const data = await response.json();
                
                if (data.success && data.result) {
                    // Display results in table
                    let html = '<table class="result-table"><thead><tr>';
                    if (data.result.length > 0) {
                        Object.keys(data.result[0]).forEach(key => {
                            html += `<th>${key}</th>`;
                        });
                    }
                    html += '</tr></thead><tbody>';
                    
                    data.result.forEach(row => {
                        html += '<tr>';
                        Object.values(row).forEach(val => {
                            html += `<td>${val}</td>`;
                        });
                        html += '</tr>';
                    });
                    
                    html += '</tbody></table>';
                    resultsDiv.innerHTML = html;
                } else {
                    resultsDiv.innerHTML = `<div style="padding: 20px; background: #fff3cd; border-radius: 10px;">${data.error || 'No results'}</div>`;
                }
            } catch (error) {
                resultsDiv.innerHTML = `<div style="padding: 20px; background: #f8d7da; border-radius: 10px;">×©×’×™××”: ${error.message}</div>`;
            }
        }

        // Memory
        async function loadMemoryStats() {
            try {
                const response = await fetch(`${API_URL}/api/memory/stats`);
                const data = await response.json();

                // Handle the response structure
                const stats = data.stats || {};
                
                // Update the display with actual data
                document.getElementById('memoriesCount').textContent = stats.total_conversations || stats.conversations || 0;
                document.getElementById('conversationsCount').textContent = stats.conversations_24h || 0;
                document.getElementById('responsesCount').textContent = stats.total_preferences || stats.total_facts || 0;
                
                // Log to console for debugging
                console.log('Memory Stats:', stats);
            } catch (error) {
                console.error('Failed to load memory stats:', error);
                // Keep the default 0 values if there's an error
            }
        }

        // Email
        async function loadEmails() {
            const emailList = document.getElementById('emailList');
            emailList.innerHTML = '<div class="loading">×˜×•×¢×Ÿ ××™××™×™×œ×™×</div>';

            try {
                const response = await fetch(`${API_URL}/api/tools/email`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        action: 'recent',
                        count: 10
                    })
                });

                const data = await response.json();
                
                if (data.success && data.result && Array.isArray(data.result)) {
                    let html = '';
                    data.result.forEach(email => {
                        html += `
                            <div class="email-item">
                                <div class="email-header">
                                    <span class="email-from">${email.from || email.sender || 'Unknown'}</span>
                                    <span class="email-date">${email.date || ''}</span>
                                </div>
                                <div class="email-subject">${email.subject || 'No subject'}</div>
                                <div class="email-preview">${(email.snippet || email.body || '').substring(0, 100)}...</div>
                            </div>
                        `;
                    });
                    emailList.innerHTML = html || '<div class="email-item"><p style="text-align:center;">××™×Ÿ ××™××™×™×œ×™×</p></div>';
                } else {
                    emailList.innerHTML = '<div class="email-item"><p>×œ× ×”×¦×œ×—×ª×™ ×œ×˜×¢×•×Ÿ ××™××™×™×œ×™×</p></div>';
                }
            } catch (error) {
                emailList.innerHTML = `
                    <div class="email-item" style="background: #fff3cd; border-color: #ffc107;">
                        <p style="font-weight: bold; color: #856404;">âš ï¸ Gmail ×œ× ××•×’×“×¨</p>
                        <p style="font-size: 14px;">×§×•×‘×¥ credentials.json ×œ× × ××¦×</p>
                        <hr style="margin: 15px 0; border: none; border-top: 1px solid #ddd;">
                        <p style="font-size: 13px; margin-bottom: 10px;"><strong>×›×“×™ ×œ×˜×¢×•×Ÿ ××™××™×™×œ×™×:</strong></p>
                        <ol style="font-size: 12px; padding-right: 20px; line-height: 1.8;">
                            <li>×œ×š ×œ-<a href="https://console.cloud.google.com/apis/credentials" target="_blank" style="color: #00d9ff;">Google Cloud Console</a></li>
                            <li>×¦×•×¨ OAuth 2.0 Client ID</li>
                            <li>×”×•×¨×“ ××ª ×”×§×•×‘×¥ ×›-credentials.json</li>
                            <li>×©×™× ××•×ª×• ×‘×ª×™×§×™×™×”: C:\\AI-ALL-PRO\\ZERO\\</li>
                        </ol>
                        <p style="font-size: 11px; margin-top: 15px; color: #999;">
                            ğŸ“– ××“×¨×™×š ××¤×•×¨×˜: ×¤×ª×— ××ª ×”×§×•×‘×¥ GMAIL_SETUP_GUIDE.md
                        </p>
                    </div>
                `;
            }
        }

        // Streaming Functions
        let isStreamingActive = false;
        let currentStreamingInterval = null;

        function toggleStreaming() {
            streamingMode = !streamingMode;
            const btn = document.getElementById('streamBtn');
            if (streamingMode) {
                btn.style.background = '#28a745';
                btn.textContent = 'âœ“ Streaming ON';
            } else {
                btn.style.background = '#7c3aed';
                btn.textContent = 'ğŸ“¡ Streaming';
            }
        }

        function stopConversation() {
            if (currentStreamingInterval) {
                clearInterval(currentStreamingInterval);
                currentStreamingInterval = null;
            }
            isStreamingActive = false;
            document.getElementById('stopBtn').style.display = 'none';
            document.getElementById('sendBtn').style.display = 'inline-block';
        }

        function copyConversation() {
            const chatMessages = document.querySelectorAll('.message');
            let conversationText = '';
            
            chatMessages.forEach(msg => {
                const header = msg.querySelector('.message-header');
                const content = msg.textContent;
                if (header) {
                    conversationText += header.textContent + '\n';
                }
                conversationText += content.replace(/.*message-header.*\n/, '') + '\n\n';
            });
            
            navigator.clipboard.writeText(conversationText).then(() => {
                alert('âœ… ×”×©×™×—×” ×”×•×¢×ª×§×” ×œ×œ×•×—');
            }).catch(err => {
                console.error('Failed to copy:', err);
                alert('âŒ ×œ× ×”×¦×œ×—×ª×™ ×œ×”×¢×ª×™×§ ××ª ×”×©×™×—×”');
            });
        }

        function saveConversation() {
            const chatMessages = document.querySelectorAll('.message');
            const conversation = {
                timestamp: new Date().toISOString(),
                messages: []
            };
            
            chatMessages.forEach(msg => {
                const isUser = msg.classList.contains('user-message');
                const content = msg.textContent.replace(/.*message-header.*/, '').trim();
                conversation.messages.push({
                    role: isUser ? 'user' : 'zero',
                    content: content,
                    timestamp: new Date().toISOString()
                });
            });
            
            localStorage.setItem(`conversation_${Date.now()}`, JSON.stringify(conversation));
            alert('âœ… ×”×©×™×—×” × ×©××¨×”!');
            loadSavedConversations();
        }

        function loadSavedConversations() {
            const conversationsList = document.getElementById('conversationsList');
            if (!conversationsList) return;
            
            let conversations = [];
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key.startsWith('conversation_')) {
                    const conv = JSON.parse(localStorage.getItem(key));
                    conversations.push({ key, ...conv });
                }
            }
            
            conversations.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
            
            conversationsList.innerHTML = conversations.map((conv, idx) => `
                <div class="saved-conversation" onclick="loadConversation('${conv.key}')">
                    <div class="conv-header">×©×™×—×” ${idx + 1}</div>
                    <div class="conv-date">${new Date(conv.timestamp).toLocaleString('he-IL')}</div>
                    <div class="conv-preview">${conv.messages.length} ×”×•×“×¢×•×ª</div>
                </div>
            `).join('');
        }

        function loadConversation(key) {
            const conv = JSON.parse(localStorage.getItem(key));
            const chat = document.getElementById('chatMessages');
            
            if (!confirm('×”×× ××ª×” ×‘×˜×•×—? ×–×” ×™××—×§ ××ª ×”×©×™×—×” ×”× ×•×›×—×™×ª.')) return;
            
            chat.innerHTML = '';
            
            conv.messages.forEach(msg => {
                addMessageToChat(msg.role, msg.content);
            });
            
            chat.scrollTop = chat.scrollHeight;
        }

        async function sendMessage() {
            if (streamingMode) {
                await sendStreamingMessage();
                return;
            }

            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            if (!message) return;

            // Add user message
            addMessageToChat('user', message);
            input.value = '';

            // Add loading message
            const loadingId = addMessageToChat('zero', '××—×¤×© ×ª×©×•×‘×”...', 'loading');

            try {
                const response = await fetch(`${API_URL}/api/chat`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        message: message,
                        use_memory: true
                    })
                });

                const data = await response.json();

                // Update loading message with actual response
                const responseText = data.response || data.error || '××™×Ÿ ×ª×©×•×‘×”';
                document.getElementById(loadingId).innerHTML = `
                    <div class="message-header">ğŸ¤– Zero Agent</div>
                    ${responseText}
                    ${getModelInfoDisplay(data.model_used, true)}
                `;

                // Auto-detect and show code artifacts
                detectAndShowArtifacts(responseText);

            } catch (error) {
                console.error('Error:', error);
                document.getElementById(loadingId).innerHTML = `
                    <div class="message-header">âŒ ×©×’×™××”</div>
                    ×œ× ×”×¦×œ×—×ª×™ ×œ×”×ª×—×‘×¨ ×œ×©×¨×ª. ×•×“× ×©×”×©×¨×ª ×¨×¥ ×‘-${API_URL}
                `;
            }
        }

        async function sendStreamingMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            if (!message) return;

            // Add user message
            addMessageToChat('user', message);
            input.value = '';

            // Add streaming message
            const streamingId = addMessageToChat('zero', '', 'streaming');

            // Show stop button
            isStreamingActive = true;
            document.getElementById('stopBtn').style.display = 'inline-block';
            document.getElementById('sendBtn').style.display = 'none';

            try {
                // Note: This would connect to WebSocket when implemented
                // For now, use regular API but show it's streaming mode
                const response = await fetch(`${API_URL}/api/chat`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        message: message,
                        use_memory: true
                    })
                });

                const data = await response.json();

                // Simulate streaming by adding text gradually
                const text = data.response || data.error || '××™×Ÿ ×ª×©×•×‘×”';
                let currentText = '';
                let index = 0;

                currentStreamingInterval = setInterval(() => {
                    if (!isStreamingActive) {
                        clearInterval(currentStreamingInterval);
                        return;
                    }
                    
                    if (index < text.length) {
                        currentText += text[index];
                        document.getElementById(streamingId).innerHTML = `
                            <div class="message-header">ğŸ¤– Zero Agent (Streaming Mode)</div>
                            ${currentText}
                        `;
                        index++;
                    } else {
                        clearInterval(currentStreamingInterval);
                        document.getElementById(streamingId).innerHTML = `
                            <div class="message-header">ğŸ¤– Zero Agent (Streaming Mode)</div>
                            ${currentText}
                            ${getModelInfoDisplay(data.model_used, true)}
                        `;
                        stopConversation();
                    }
                }, 10); // 10ms per character for smooth streaming effect

            } catch (error) {
                console.error('Error:', error);
                document.getElementById(streamingId).innerHTML = `
                    <div class="message-header">âŒ ×©×’×™××”</div>
                    ×œ× ×”×¦×œ×—×ª×™ ×œ×”×ª×—×‘×¨ ×œ×©×¨×ª. ×•×“× ×©×”×©×¨×ª ×¨×¥ ×‘-${API_URL}
                `;
                stopConversation();
            }
        }

        // Cursor Integration
        async function connectToCursor() {
            const confirmConnect = confirm('×”×× ××ª×” ×¨×•×¦×” ×œ×—×‘×¨ ××ª Zero Agent ×œ-Cursor?\n\n×–×” ×™××¤×©×¨ ×œ×š ×œ×”×©×ª××© ×‘-Zero ×™×©×™×¨×•×ª ×-Cursor IDE.');
            
            if (!confirmConnect) return;
            
            try {
                // Create a note for Cursor integration
                const cursorNote = `
# Zero Agent Integration

×›×“×™ ×œ×”×©×ª××© ×‘-Zero Agent ×‘-Cursor:

1. ×©×œ×‘ ××ª ×”×§×•×“ ×”×‘× ×‘-.cursorrules ××• ×‘×¤×¨×•×™×§×˜ ×©×œ×š:

\`\`\`python
import requests

def ask_zero(query):
    """×©××œ ××ª Zero Agent"""
    response = requests.post('http://localhost:8080/api/chat', json={
        "message": query,
        "use_memory": True
    })
    return response.json()['response']
\`\`\`

2. ××• ×¤×©×•×˜ ×¦×™×™×Ÿ: "ask zero" ××• "use zero" ×‘-Cursor

3. Zero Agent ×¨×¥ ×‘: http://localhost:8080

---

×‘×“×•×§ ×©×”×©×¨×ª ×¨×¥:
\`\`\`bash
python api_server.py
\`\`\`

×××©×§ ××™× ×˜×¨× ×˜: ×¤×ª×— ××ª zero_web_interface.html
                `;
                
                // Copy to clipboard (requires HTTPS or localhost)
                if (navigator.clipboard) {
                    await navigator.clipboard.writeText(cursorNote);
                    alert('âœ… ×”×•×¨××•×ª ×—×™×‘×•×¨ ×œ-Cursor ×”×•×¢×ª×§×• ×œ×œ×•×—!\n\n×¤×ª×— ×§×•×‘×¥ ×—×“×© ×‘-Cursor ×•×”×“×‘×§ ××ª ×”×ª×•×›×Ÿ.');
                } else {
                    // Fallback: show in a modal
                    const modal = document.createElement('div');
                    modal.style.cssText = 'position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);z-index:9999;padding:50px;overflow:auto;';
                    modal.innerHTML = `
                        <div style="background:white;padding:30px;border-radius:15px;max-width:800px;margin:0 auto;">
                            <h2 style="color:#00d9ff;margin-bottom:20px;">ğŸ“‹ ×”×•×¨××•×ª ×—×™×‘×•×¨ ×œ-Cursor</h2>
                            <pre style="background:#f5f5f5;padding:20px;border-radius:10px;overflow:auto;max-height:500px;">${cursorNote}</pre>
                            <button onclick="this.closest('div[style*=background]').parentElement.remove()" style="margin-top:20px;padding:12px 30px;background:#00d9ff;color:white;border:none;border-radius:10px;cursor:pointer;font-weight:bold;">×¡×’×•×¨</button>
                        </div>
                    `;
                    document.body.appendChild(modal);
                }
                
            } catch (error) {
                alert('âŒ ×©×’×™××” ×‘×”×¢×ª×§×ª ×”×˜×§×¡×˜. ×× × ×”×¢×ª×§ ×™×“× ×™×ª.');
                console.error('Error:', error);
            }
        }
        
        // Add Cursor button
        window.addEventListener('load', function() {
            const header = document.querySelector('.header');
            if (header) {
                const cursorBtn = document.createElement('button');
                cursorBtn.textContent = 'ğŸ”— ×—×™×‘×•×¨ ×œ-Cursor';
                cursorBtn.className = 'send-btn';
                cursorBtn.style.marginRight = '10px';
                cursorBtn.onclick = connectToCursor;
                header.appendChild(cursorBtn);
            }
        });

        // Project Review
        async function reviewProject() {
            const projectPath = document.getElementById('projectPath').value;
            const reviewType = document.getElementById('reviewType').value;
            const resultsDiv = document.getElementById('projectReviewResults');

            if (!projectPath) {
                alert('×× × ×”×–×Ÿ × ×ª×™×‘ ×œ×¤×¨×•×™×§×˜');
                return;
            }

            resultsDiv.innerHTML = '<div class="loading">×‘×•×“×§ ×¤×¨×•×™×§×˜...</div>';

            try {
                const response = await fetch(`${API_URL}/api/tools/project-review`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        project_path: projectPath,
                        review_type: reviewType
                    })
                });

                const data = await response.json();

                if (data.success) {
                    const result = data.result;
                    
                    let html = `
                        <div style="background: #f9f9f9; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                            <h3 style="color: #00d9ff; margin-bottom: 15px;">ğŸ“Š ×¡×˜×˜×™×¡×˜×™×§×•×ª ×”×¤×¨×•×™×§×˜</h3>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                                <div>
                                    <div style="font-weight: bold; color: #00d9ff;">×§×‘×¦×™×</div>
                                    <div style="font-size: 24px; font-weight: bold;">${result.stats.total_files}</div>
                                </div>
                                <div>
                                    <div style="font-weight: bold; color: #00d9ff;">×’×•×“×œ</div>
                                    <div style="font-size: 24px; font-weight: bold;">${result.stats.total_size_mb} MB</div>
                                </div>
                                <div>
                                    <div style="font-weight: bold; color: #00d9ff;">×¡×•×’ ×¡×§×™×¨×”</div>
                                    <div style="font-size: 14px;">${result.review_type}</div>
                                </div>
                            </div>
                        </div>

                        <div style="background: white; padding: 25px; border-radius: 10px; border: 2px solid #e0e0e0;">
                            <h3 style="color: #00d9ff; margin-bottom: 15px;">ğŸ’¡ ×—×•×•×ª ×“×¢×ª ××§×¦×•×¢×™×ª</h3>
                            <div style="white-space: pre-wrap; line-height: 1.6; color: #333;">${result.review}</div>
                        </div>

                        ${result.stats.sample_files.length > 0 ? `
                            <div style="background: #f9f9f9; padding: 20px; border-radius: 10px; margin-top: 20px;">
                                <h4 style="color: #00d9ff; margin-bottom: 10px;">ğŸ“ ×§×‘×¦×™× × ×¡×¨×§×• (×“×•×’××”)</h4>
                                <div style="max-height: 200px; overflow-y: auto;">
                                    ${result.stats.sample_files.map(file => `<div style="padding: 5px; font-family: monospace; font-size: 12px;">ğŸ“„ ${file}</div>`).join('')}
                                </div>
                            </div>
                        ` : ''}

                        <div style="background: #fff3cd; padding: 20px; border-radius: 10px; margin-top: 20px; border: 2px solid #ffc107;">
                            <h3 style="color: #856404; margin-bottom: 15px;">ğŸ’¬ ×”××©×š ×©×™×—×” ×¢×œ ×”×¤×¨×•×™×§×˜</h3>
                            <p style="color: #856404; margin-bottom: 15px;">
                                ××ª×” ×™×›×•×œ ×œ×”××©×™×š ×œ×©×•×—×— ×¢× Zero ×¢×œ ×”×¤×¨×•×™×§×˜, ×œ×‘×§×© ×”×¡×‘×¨×™× ×¢×œ ×”×”××œ×¦×•×ª, ×¢×–×¨×” ×‘×™×™×©×•×, ××• ×œ×”×ª×™×™×¢×¥ ×¢×œ ×©×™×¤×•×¨×™× × ×•×¡×¤×™×.
                            </p>
                            <div id="projectChatArea" style="margin-top: 20px;">
                                <div style="margin-bottom: 15px; display: flex; gap: 10px; flex-wrap: wrap;">
                                    <button onclick="document.getElementById('projectChatInput').value='×‘×¦×¢ ×”××œ×¦×” ××¡×¤×¨ 1'; sendProjectChatMessage();" 
                                            style="padding: 8px 15px; background: #28a745; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 13px;">
                                        âœ… ×‘×¦×¢ ×”××œ×¦×” #1
                                    </button>
                                    <button onclick="document.getElementById('projectChatInput').value='××™×š ×× ×™ ×™×›×•×œ ×œ×©×¤×¨ ××ª ×”×¤×¨×•×™×§×˜?'; sendProjectChatMessage();" 
                                            style="padding: 8px 15px; background: #17a2b8; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 13px;">
                                        ğŸ’¡ ××™×š ×œ×©×¤×¨?
                                    </button>
                                    <button onclick="document.getElementById('projectChatInput').value='×ª×¡×‘×™×¨ ×œ×™ ××ª ×”×”××œ×¦×•×ª'; sendProjectChatMessage();" 
                                            style="padding: 8px 15px; background: #ffc107; color: #333; border: none; border-radius: 6px; cursor: pointer; font-size: 13px;">
                                        ğŸ“– ×”×¡×‘×¨ ×”××œ×¦×•×ª
                                    </button>
                                </div>
                                <div id="projectChatMessages" style="max-height: 300px; overflow-y: auto; background: white; padding: 15px; border-radius: 10px; margin-bottom: 15px; border: 1px solid #ddd;">
                                    <div class="message zero" style="margin: 10px 0; padding: 10px; background: #f9f9f9; border-radius: 8px;">
                                        <div class="message-header" style="font-size: 11px; opacity: 0.7; margin-bottom: 5px;">ğŸ¤– Zero Agent</div>
                                        ×× ×™ ××•×›×Ÿ ×œ×¢×–×•×¨ ×œ×š ×¢× ×”×¤×¨×•×™×§×˜! ××ª×” ×™×›×•×œ ×œ×©××•×œ ×©××œ×•×ª ×¢×œ ×”×”××œ×¦×•×ª, ×œ×‘×§×© ×¢×–×¨×” ×‘×™×™×©×•×, ××• ×œ×”×ª×™×™×¢×¥ ×¢×œ ×©×™×¤×•×¨×™× × ×•×¡×¤×™×.
                                    </div>
                                </div>
                                <div style="display: flex; gap: 10px;">
                                    <input type="text" id="projectChatInput" placeholder="×©××œ ×©××œ×” ××• ×‘×§×© ×¢×–×¨×”..." 
                                           style="flex: 1; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 14px;"
                                           onkeypress="if(event.key === 'Enter') sendProjectChatMessage()">
                                    <button onclick="sendProjectChatMessage()" 
                                            style="padding: 12px 25px; background: #00d9ff; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                                        ×©×œ×—
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;

                    resultsDiv.innerHTML = html;
                    window.currentProjectPath = projectPath;
                } else {
                    resultsDiv.innerHTML = `
                        <div style="background: #f8d7da; color: #721c24; padding: 20px; border-radius: 10px;">
                            <strong>âŒ ×©×’×™××”:</strong> ${data.error}
                        </div>
                    `;
                }

            } catch (error) {
                resultsDiv.innerHTML = `
                    <div style="background: #f8d7da; color: #721c24; padding: 20px; border-radius: 10px;">
                        <strong>âŒ ×©×’×™××”:</strong> ${error.message}
                    </div>
                `;
            }
        }

        // Project Chat Functions
        function addProjectChatMessage(sender, text) {
            const messagesDiv = document.getElementById('projectChatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            messageDiv.style.cssText = 'margin: 10px 0; padding: 10px; border-radius: 8px; max-width: 80%;';
            
            if (sender === 'zero') {
                messageDiv.style.background = '#f9f9f9';
                messageDiv.innerHTML = `
                    <div class="message-header" style="font-size: 11px; opacity: 0.7; margin-bottom: 5px;">ğŸ¤– Zero Agent</div>
                    ${text}
                `;
            } else {
                messageDiv.style.background = '#00d9ff';
                messageDiv.style.color = 'white';
                messageDiv.style.marginLeft = 'auto';
                messageDiv.style.textAlign = 'right';
                messageDiv.innerHTML = `
                    <div class="message-header" style="font-size: 11px; opacity: 0.9; margin-bottom: 5px;">ğŸ‘¤ ××ª×”</div>
                    ${text}
                `;
            }
            
            messagesDiv.appendChild(messageDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }

        async function sendProjectChatMessage() {
            const input = document.getElementById('projectChatInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            // Add user message
            addProjectChatMessage('user', message);
            input.value = '';
            
            // Add loading message
            const loadingId = 'loading-' + Date.now();
            addProjectChatMessage('zero', '××—×¤×© ×ª×©×•×‘×”...');
            
            try {
                // Create context about the project for better responses
                const projectContext = window.currentProjectPath 
                    ? `\n\n×”×§×©×¨: ×× ×™ ×¢×•×‘×“ ×¢×œ ×”×¤×¨×•×™×§×˜ '${window.currentProjectPath}'. `
                    : '';
                
                const response = await fetch(`${API_URL}/api/chat`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        message: message + projectContext + ' ×× × ×¢× ×” ×‘×”×ª×× ×œ×¡×§×™×¨×ª ×”×¤×¨×•×™×§×˜ ×©×¢×©×ª×™.',
                        use_memory: true
                    })
                });

                const data = await response.json();
                
                // Remove loading message
                const messagesDiv = document.getElementById('projectChatMessages');
                const lastMessage = messagesDiv.lastElementChild;
                if (lastMessage && lastMessage.textContent.includes('××—×¤×© ×ª×©×•×‘×”')) {
                    lastMessage.remove();
                }
                
                // Add Zero's response
                const responseText = data.response || data.error || '×œ× ×§×™×‘×œ×ª×™ ×ª×©×•×‘×”';
                addProjectChatMessage('zero', responseText);
                
            } catch (error) {
                console.error('Error:', error);
                
                // Remove loading message
                const messagesDiv = document.getElementById('projectChatMessages');
                const lastMessage = messagesDiv.lastElementChild;
                if (lastMessage && lastMessage.textContent.includes('××—×¤×© ×ª×©×•×‘×”')) {
                    lastMessage.remove();
                }
                
                addProjectChatMessage('zero', 'âŒ ×œ× ×”×¦×œ×—×ª×™ ×œ×”×ª×—×‘×¨ ×œ×©×¨×ª. ×•×“× ×©×”×©×¨×ª ×¨×¥ ×‘-' + API_URL);
            }
        }

        // ========================================
        // Projects System - Phase 1
        // ========================================
        
        let currentProjectId = null;
        let projects = {};

        // Load projects from localStorage
        function loadProjects() {
            const saved = localStorage.getItem('zero_projects');
            if (saved) {
                projects = JSON.parse(saved);
            } else {
                // Create default project
                projects = {
                    'default': {
                        id: 'default',
                        name: '×¤×¨×•×™×§×˜ ×‘×¨×™×¨×ª ××—×“×œ',
                        chats: [],
                        context: ''
                    }
                };
                saveProjects();
            }
            renderProjects();
            
            // Set default project as active
            if (!currentProjectId) {
                currentProjectId = 'default';
            }
        }

        // Save projects to localStorage
        function saveProjects() {
            localStorage.setItem('zero_projects', JSON.stringify(projects));
        }

        // Render projects in sidebar
        function renderProjects() {
            const container = document.getElementById('projects-list');
            container.innerHTML = '';
            
            Object.values(projects).forEach(project => {
                const projectDiv = document.createElement('div');
                projectDiv.className = `nav-item ${currentProjectId === project.id ? 'active' : ''}`;
                projectDiv.onclick = () => switchProject(project.id);
                projectDiv.innerHTML = `
                    <span class="icon">ğŸ“</span>
                    <span>${project.name}</span>
                `;
                container.appendChild(projectDiv);
            });
        }

        // Switch to different project
        function switchProject(projectId) {
            // Save current context before switching
            if (currentProjectId) {
                const messagesDiv = document.getElementById('chatMessages');
                if (messagesDiv) {
                    projects[currentProjectId].context = messagesDiv.innerHTML;
                    saveProjects();
                }
            }
            
            currentProjectId = projectId;
            renderProjects();
            
            // Load project context
            const project = projects[projectId];
            if (project && project.context) {
                document.getElementById('chatMessages').innerHTML = project.context;
            } else {
                document.getElementById('chatMessages').innerHTML = '';
            }
            
            // Show chat view without triggering event
            document.querySelectorAll('.content-area').forEach(area => {
                area.classList.remove('active');
            });
            document.getElementById('chat').classList.add('active');
        }

        // Show new project dialog
        function showNewProjectDialog() {
            const name = prompt('××™×š × ×§×¨× ×œ×¤×¨×•×™×§×˜ ×”×—×“×©?');
            if (name && name.trim()) {
                const id = 'proj-' + Date.now();
                projects[id] = {
                    id: id,
                    name: name.trim(),
                    chats: [],
                    context: ''
                };
                saveProjects();
                renderProjects();
                switchProject(id);
            }
        }

        // Save chat context to current project
        function saveChatContext(messageId) {
            if (!currentProjectId) return;
            
            const messagesDiv = document.getElementById('chatMessages');
            const chatHTML = messagesDiv.innerHTML;
            
            projects[currentProjectId].context = chatHTML;
            projects[currentProjectId].chats.push({
                id: messageId,
                timestamp: new Date().toISOString()
            });
            
            saveProjects();
        }

        // Override addMessageToChat to save context
        const originalAddMessage = window.addMessageToChat;
        window.addMessageToChat = function(sender, text, id) {
            const messageId = originalAddMessage.call(this, sender, text, id);
            if (currentProjectId) {
                saveChatContext(messageId);
            }
            return messageId;
        };

        // Initialize projects on load
        loadProjects();

        // ========================================
        // Artifacts System - Phase 3
        // ========================================
        
        function showArtifact(type, title, content) {
            const artifactsZone = document.getElementById('artifactsZone');
            const container = document.getElementById('artifactsContainer');
            
            // Show artifacts zone
            artifactsZone.style.display = 'block';
            
            // Create artifact
            const artifact = document.createElement('div');
            artifact.className = 'artifact';
            artifact.dataset.type = type;
            artifact.dataset.title = title;
            
            artifact.innerHTML = `
                <div class="artifact-header">
                    <span class="artifact-title">ğŸ“„ ${title}</span>
                    <div class="artifact-actions">
                        <button class="artifact-btn" onclick="copyArtifact('${title}', event)">ğŸ“‹ ×”×¢×ª×§</button>
                        <button class="artifact-btn" onclick="downloadArtifact('${title}', event)">ğŸ’¾ ×”×•×¨×“</button>
                        <button class="artifact-btn" onclick="removeArtifact(event)">ğŸ—‘ï¸ ××—×§</button>
                    </div>
                </div>
                <div class="artifact-content">${escapeHtml(content)}</div>
            `;
            
            // Add to container
            container.insertBefore(artifact, container.firstChild);
            
            // Scroll to top
            artifactsZone.scrollTop = 0;
        }
        
        function closeArtifacts() {
            document.getElementById('artifactsZone').style.display = 'none';
        }
        
        function copyArtifact(title, event) {
            event.stopPropagation();
            const artifact = event.target.closest('.artifact');
            const content = artifact.querySelector('.artifact-content').textContent;
            
            navigator.clipboard.writeText(content).then(() => {
                alert(`âœ… ×”×•×¢×ª×§: ${title}`);
            });
        }
        
        function downloadArtifact(title, event) {
            event.stopPropagation();
            const artifact = event.target.closest('.artifact');
            const content = artifact.querySelector('.artifact-content').textContent;
            
            const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = title;
            a.click();
            URL.revokeObjectURL(url);
        }
        
        function removeArtifact(event) {
            event.stopPropagation();
            const artifact = event.target.closest('.artifact');
            artifact.remove();
            
            // Hide artifacts zone if empty
            const container = document.getElementById('artifactsContainer');
            if (container.children.length === 0) {
                closeArtifacts();
            }
        }
        
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        // Auto-detect code blocks in Zero responses
        function detectAndShowArtifacts(messageText) {
            // Detect code blocks
            const codeBlockRegex = /```(\w+)?\n?([\s\S]*?)```/g;
            let match;
            let artifactCount = 0;
            
            while ((match = codeBlockRegex.exec(messageText)) !== null) {
                const language = match[1] || 'code';
                const code = match[2];
                const extension = language === 'python' ? 'py' : language === 'javascript' ? 'js' : 'txt';
                const filename = `artifact_${Date.now()}_${artifactCount}.${extension}`;
                
                showArtifact(language, filename, code);
                artifactCount++;
            }
        }

        // ========================================
        // New Artifacts Panel Functions
        // ========================================
        
        let currentArtifact = { code: '', preview: '' };
        let currentArtifactsTab = 'preview';
        
        function toggleArtifactsPanel() {
            const panel = document.getElementById('artifactsPanel');
            panel.classList.toggle('open');
        }
        
        function switchArtifactsTab(tab) {
            currentArtifactsTab = tab;
            
            // Update tab styles
            document.querySelectorAll('.artifacts-tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            
            // Show/hide content
            const previewDiv = document.getElementById('artifactsPreview');
            const codeDiv = document.getElementById('artifactsCode');
            
            if (tab === 'preview') {
                previewDiv.style.display = 'block';
                codeDiv.style.display = 'none';
            } else {
                previewDiv.style.display = 'none';
                codeDiv.style.display = 'block';
            }
        }
        
        function updateArtifactsPanel(code, preview = null) {
            currentArtifact.code = code;
            currentArtifact.preview = preview || code;
            
            // Update code view
            document.getElementById('artifactsCode').innerHTML = `<pre><code>${escapeHtml(code)}</code></pre>`;
            
            // Update preview
            if (preview) {
                document.getElementById('artifactsPreview').innerHTML = preview;
            } else {
                document.getElementById('artifactsPreview').innerHTML = `<pre style="white-space: pre-wrap; font-family: monospace;">${escapeHtml(code)}</pre>`;
            }
            
            // Open panel if not already open
            const panel = document.getElementById('artifactsPanel');
            if (!panel.classList.contains('open')) {
                panel.classList.add('open');
            }
        }
        
        function copyArtifactCode() {
            if (!currentArtifact.code) {
                alert('××™×Ÿ ×§×•×“ ×œ×”×¢×ª×§×”');
                return;
            }
            
            navigator.clipboard.writeText(currentArtifact.code).then(() => {
                alert('âœ… ×”×§×•×“ ×”×•×¢×ª×§ ×œ×œ×•×—');
            }).catch(err => {
                alert('âŒ ×©×’×™××” ×‘×”×¢×ª×§×”: ' + err);
            });
        }
        
        function downloadArtifact() {
            if (!currentArtifact.code) {
                alert('××™×Ÿ ×§×•×“ ×œ×”×•×¨×“×”');
                return;
            }
            
            const blob = new Blob([currentArtifact.code], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `artifact_${Date.now()}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        function clearArtifacts() {
            currentArtifact = { code: '', preview: '' };
            document.getElementById('artifactsPreview').innerHTML = '<p style="color: var(--claude-text-light); text-align: center; margin-top: 40px;">××™×Ÿ ×ª×•×›×Ÿ ×œ×”×¦×’×” ×›×¨×’×¢</p>';
            document.getElementById('artifactsCode').innerHTML = '<pre><code>// No code to display</code></pre>';
        }

        // ========================================
        // Mobile Sidebar Functions
        // ========================================
        
        function toggleMobileSidebar() {
            const sidebar = document.getElementById('sidebar');
            const backdrop = document.querySelector('.sidebar-backdrop');
            
            if (sidebar.classList.contains('open')) {
                closeMobileSidebar();
            } else {
                openMobileSidebar();
            }
        }
        
        function openMobileSidebar() {
            const sidebar = document.getElementById('sidebar');
            const backdrop = document.querySelector('.sidebar-backdrop');
            
            sidebar.classList.add('open');
            backdrop.classList.add('active');
            document.body.style.overflow = 'hidden'; // Prevent background scroll
        }
        
        function closeMobileSidebar() {
            const sidebar = document.getElementById('sidebar');
            const backdrop = document.querySelector('.sidebar-backdrop');
            
            sidebar.classList.remove('open');
            backdrop.classList.remove('active');
            document.body.style.overflow = ''; // Restore scroll
        }

        // Close mobile sidebar when clicking on navigation items
        document.addEventListener('DOMContentLoaded', function() {
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => {
                item.addEventListener('click', function() {
                    if (window.innerWidth <= 768) {
                        closeMobileSidebar();
                    }
                });
            });
        });

        // Handle window resize
        window.addEventListener('resize', function() {
            if (window.innerWidth > 768) {
                closeMobileSidebar();
            }
        });

        // Add viewport meta tag for proper mobile scaling
        if (!document.querySelector('meta[name="viewport"]')) {
            const viewport = document.createElement('meta');
            viewport.name = 'viewport';
            viewport.content = 'width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes';
            document.head.appendChild(viewport);
        }

        // Initialize
        initCalendar();
    </script>
</body>
</html>
